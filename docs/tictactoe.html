<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Tic Tac Toe Futurista</title>
  <style>
    body {
      margin: 0;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: radial-gradient(circle at center, #0a0f1c, #000);
      color: #fff;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      height: 100vh;
      overflow: hidden;
    }
    h1 {
      font-size: 2.5rem;
      color: #0ff;
      text-shadow: 0 0 10px #0ff;
      margin-bottom: 10px;
    }
    .controls {
      margin-bottom: 20px;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 10px;
    }
    .btn {
      background: #111;
      border: 2px solid #0ff;
      color: #0ff;
      padding: 8px 16px;
      border-radius: 12px;
      font-size: 1rem;
      cursor: pointer;
      transition: all 0.3s ease;
      text-shadow: 0 0 5px #0ff;
    }
    .btn:hover {
      background: #0ff;
      color: #111;
      box-shadow: 0 0 20px #0ff;
    }
    select {
      background: #111;
      border: 2px solid #0ff;
      color: #0ff;
      border-radius: 8px;
      padding: 6px;
      font-size: 1rem;
      text-shadow: 0 0 5px #0ff;
    }
    .board {
      display: grid;
      grid-template-columns: repeat(3, 100px);
      grid-template-rows: repeat(3, 100px);
      gap: 8px;
      margin-bottom: 20px;
    }
    .cell {
      background: #111;
      border: 2px solid #0ff;
      border-radius: 16px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 2.5rem;
      font-weight: bold;
      color: #ff00ff;
      text-shadow: 0 0 10px #ff00ff;
      cursor: pointer;
      transition: all 0.3s ease;
    }
    .cell.taken {
      cursor: not-allowed;
    }
    .cell.x {
      color: #0ff;
      text-shadow: 0 0 15px #0ff;
    }
    .cell.o {
      color: #ff0;
      text-shadow: 0 0 15px #ff0;
    }
    .message {
      font-size: 1.5rem;
      margin-bottom: 15px;
      text-shadow: 0 0 8px #fff;
    }
    .scoreboard {
      margin-bottom: 15px;
      font-size: 1rem;
      display: flex;
      gap: 15px;
    }
    .scoreboard span {
      color: #0ff;
      text-shadow: 0 0 8px #0ff;
    }
  </style>
</head>
<body>
  <h1>Tic Tac Toe Futurista</h1>
  <div class="controls">
    <div>
      <label>Elige tu ficha:</label>
      <button class="btn" onclick="chooseSymbol('X')">X</button>
      <button class="btn" onclick="chooseSymbol('O')">O</button>
    </div>
    <div>
      <label>Dificultad:</label>
      <select id="difficulty">
        <option value="easy">Fácil</option>
        <option value="medium">Medio</option>
        <option value="hard">Difícil</option>
      </select>
    </div>
  </div>
  <div class="scoreboard">
    <div>Jugador: <span id="playerScore">0</span></div>
    <div>Computadora: <span id="computerScore">0</span></div>
    <div>Empates: <span id="drawScore">0</span></div>
  </div>
  <div class="board" id="board"></div>
  <div class="message" id="message"></div>
  <button class="btn" onclick="resetGame()">Reiniciar</button>

  <script>
    const boardElement = document.getElementById("board");
    const messageElement = document.getElementById("message");
    const playerScoreElement = document.getElementById("playerScore");
    const computerScoreElement = document.getElementById("computerScore");
    const drawScoreElement = document.getElementById("drawScore");
    let board, currentPlayer, playerSymbol, computerSymbol;
    let gameOver = false;
    let scores = { player: 0, computer: 0, draw: 0 };

    function initBoard() {
      board = Array(9).fill(null);
      boardElement.innerHTML = "";
      for (let i = 0; i < 9; i++) {
        const cell = document.createElement("div");
        cell.classList.add("cell");
        cell.dataset.index = i;
        cell.addEventListener("click", handleCellClick);
        boardElement.appendChild(cell);
      }
      messageElement.textContent = "";
      gameOver = false;
    }

    function chooseSymbol(symbol) {
      playerSymbol = symbol;
      computerSymbol = symbol === "X" ? "O" : "X";
      currentPlayer = "player";
      initBoard();
    }

    function handleCellClick(e) {
      if (gameOver || !playerSymbol) return;
      const index = e.target.dataset.index;
      if (!board[index]) {
        makeMove(index, playerSymbol);
        if (!checkWinner(playerSymbol)) {
          setTimeout(computerMove, 500);
        }
      }
    }

    function makeMove(index, symbol) {
      board[index] = symbol;
      const cell = boardElement.children[index];
      cell.textContent = symbol;
      cell.classList.add("taken", symbol.toLowerCase());
    }

    function computerMove() {
      let index;
      const difficulty = document.getElementById("difficulty").value;
      if (difficulty === "easy") {
        const emptyIndices = board.map((v, i) => v ? null : i).filter(v => v !== null);
        index = emptyIndices[Math.floor(Math.random() * emptyIndices.length)];
      } else if (difficulty === "medium") {
        index = findWinningMove(computerSymbol) || findWinningMove(playerSymbol);
        if (index === null) {
          const emptyIndices = board.map((v, i) => v ? null : i).filter(v => v !== null);
          index = emptyIndices[Math.floor(Math.random() * emptyIndices.length)];
        }
      } else {
        index = minimax(board, computerSymbol).index;
      }
      if (index !== null) makeMove(index, computerSymbol);
      checkWinner(computerSymbol);
    }

    function findWinningMove(symbol) {
      for (let i = 0; i < 9; i++) {
        if (!board[i]) {
          board[i] = symbol;
          if (isWinner(board, symbol)) {
            board[i] = null;
            return i;
          }
          board[i] = null;
        }
      }
      return null;
    }

    function checkWinner(symbol) {
      if (isWinner(board, symbol)) {
        gameOver = true;
        if (symbol === playerSymbol) {
          messageElement.textContent = "¡Ganaste!";
          scores.player++;
          playerScoreElement.textContent = scores.player;
        } else {
          messageElement.textContent = "Perdiste...";
          scores.computer++;
          computerScoreElement.textContent = scores.computer;
        }
        return true;
      } else if (board.every(cell => cell)) {
        gameOver = true;
        messageElement.textContent = "¡Empate!";
        scores.draw++;
        drawScoreElement.textContent = scores.draw;
        return true;
      }
      return false;
    }

    function isWinner(b, symbol) {
      const winCombos = [
        [0,1,2],[3,4,5],[6,7,8],
        [0,3,6],[1,4,7],[2,5,8],
        [0,4,8],[2,4,6]
      ];
      return winCombos.some(combo => combo.every(i => b[i] === symbol));
    }

    function minimax(newBoard, player) {
      const availSpots = newBoard.map((v,i) => v ? null : i).filter(v => v !== null);
      if (isWinner(newBoard, playerSymbol)) return { score: -10 };
      else if (isWinner(newBoard, computerSymbol)) return { score: 10 };
      else if (availSpots.length === 0) return { score: 0 };

      const moves = [];
      for (let i = 0; i < availSpots.length; i++) {
        const move = {};
        move.index = availSpots[i];
        newBoard[availSpots[i]] = player;

        if (player === computerSymbol) {
          const result = minimax(newBoard, playerSymbol);
          move.score = result.score;
        } else {
          const result = minimax(newBoard, computerSymbol);
          move.score = result.score;
        }

        newBoard[availSpots[i]] = null;
        moves.push(move);
      }

      let bestMove;
      if (player === computerSymbol) {
        let bestScore = -Infinity;
        for (let i = 0; i < moves.length; i++) {
          if (moves[i].score > bestScore) {
            bestScore = moves[i].score;
            bestMove = i;
          }
        }
      } else {
        let bestScore = Infinity;
        for (let i = 0; i < moves.length; i++) {
          if (moves[i].score < bestScore) {
            bestScore = moves[i].score;
            bestMove = i;
          }
        }
      }
      return moves[bestMove];
    }

    function resetGame() {
      initBoard();
    }

    initBoard();
  </script>
</body>
</html>
